
-- subtotals with album duration and artist's albums duration

ï»¿select artist.name as artist_name, title as album_title,
	track.name as track_name, milliseconds/ 1000 as duration_sec
from artist
	inner join album on artist.artistid = album.artistid
	inner join track on album.albumid = track.albumid
union
select artist.name , title || '- SUBTOTAL -',
	'- SUBTOTAL -', SUM(milliseconds/ 1000)
from artist
	inner join album on artist.artistid = album.artistid
	inner join track on album.albumid = track.albumid
group by 1, 2
union
select artist.name || '- SUBTOTAL -' , '- SUBTOTAL -',
	'- SUBTOTAL -', SUM(milliseconds/ 1000)
from artist
	inner join album on artist.artistid = album.artistid
	inner join track on album.albumid = track.albumid
group by 1
union
select 'zzz TOTAL  zzzz' , '- TOTAL -',
	'- TOTAL -', SUM(milliseconds/ 1000)
from artist
	inner join album on artist.artistid = album.artistid
	inner join track on album.albumid = track.albumid
order by 1, 2, 3

